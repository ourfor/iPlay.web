"use strict";(self.webpackChunkiplay=self.webpackChunkiplay||[]).push([[500],{1469:function(t,i,e){e.d(i,{H:function(){return v},R:function(){return d}});var n=e(7762),h=e(1413),s=e(5671),a=e(3144),r=e(4942),u=e(1354),o=e(2914),l=e(2175),c=e(6705),d=function(){function t(i){(0,s.Z)(this,t),(0,r.Z)(this,"Lh",void 0),this._e=i}return(0,a.Z)(t,[{key:"M",value:function(){(0,o.o8)(this.Lh)&&this.Mh()}},{key:"N",value:function(){(0,o.hj)(this.Lh)&&window.cancelAnimationFrame(this.Lh),this.Lh=void 0}},{key:"Mh",value:function(){var t=this;this.Lh=window.requestAnimationFrame((function(){(0,o.o8)(t.Lh)||(t._e(),t.Mh())}))}}]),t}(),v=function(){function t(i){(0,s.Z)(this,t),(0,r.Z)(this,"ph",void 0),(0,r.Z)(this,"Ca",null),(0,r.Z)(this,"uh",null),(0,r.Z)(this,"nh",{}),(0,r.Z)(this,"oh",new Set),this.ta=i}return(0,a.Z)(t,[{key:"instance",get:function(){return this.Ca}},{key:"setup",value:function(t,i){this.ph=i;var e=(0,u.fj)(i.$store.streamType).includes("live"),s=(0,u.fj)(i.$store.streamType).includes("ll-");this.Ca=new t((0,h.Z)({lowLatencyMode:s,backBufferLength:s?4:e?8:void 0,renderTextTracksNatively:!1},this.nh));for(var a=this.vh.bind(this),r=0,d=Object.values(t.Events);r<d.length;r++){var v=d[r];this.Ca.on(v,a)}this.Ca.on(t.Events.ERROR,this.Zb.bind(this));var f,y=(0,n.Z)(this.oh);try{for(y.s();!(f=y.n()).done;){(0,f.value)(this.Ca)}}catch(g){y.e(g)}finally{y.f()}i.player.dispatchEvent(new l.yb("hls-instance",{detail:this.Ca})),this.Ca.attachMedia(this.ta),this.Ca.on(t.Events.AUDIO_TRACK_SWITCHED,this.wh.bind(this)),this.Ca.on(t.Events.LEVEL_SWITCHED,this.xh.bind(this)),this.Ca.on(t.Events.LEVEL_LOADED,this.yh.bind(this)),this.Ca.on(t.Events.NON_NATIVE_TEXT_TRACKS_FOUND,this.zh.bind(this)),this.Ca.on(t.Events.CUES_PARSED,this.Ah.bind(this)),i.qualities[c.F]=this.Bh.bind(this),(0,l.yl)(i.qualities,"change",this.Rf.bind(this)),(0,l.yl)(i.audioTracks,"change",this.Ch.bind(this)),this.uh=(0,o.cE)(this.Dh.bind(this))}},{key:"Dh",value:function(){if(this.ph.$store.live()){var t=new d(this.Eh.bind(this));return t.M(),t.N.bind(t)}}},{key:"Eh",value:function(){var t,i;this.ph.$store.liveSyncPosition.set(null!==(t=null===(i=this.Ca)||void 0===i?void 0:i.liveSyncPosition)&&void 0!==t?t:1/0)}},{key:"vh",value:function(t,i){var e;this.ph.player.dispatchEvent(new l.yb((e=t,(0,l.Kh)(e)),{detail:i}))}},{key:"zh",value:function(t,i){for(var e=this,n=new l.yb(t,{detail:i}),h=-1,s=function(t){var s,a=i.tracks[t],r=null!==(s=a.subtitleTrack)&&void 0!==s?s:a.closedCaptions,u=new c.G({id:"hls-".concat(a.kind).concat(t),src:null===r||void 0===r?void 0:r.url,label:a.label,language:null===r||void 0===r?void 0:r.lang,kind:a.kind});u[c.H]=2,u[c.J]=function(){"showing"===u.mode?(e.Ca.subtitleTrack=t,h=t):h===t&&(e.Ca.subtitleTrack=-1,h=-1)},a.default&&u.setMode("showing",n),e.ph.textTracks.add(u,n)},a=0;a<i.tracks.length;a++)s(a)}},{key:"Ah",value:function(t,i){var e=this.ph.textTracks.getById("hls-".concat(i.track));if(e){var h,s=new l.yb(t,{detail:i}),a=(0,n.Z)(i.cues);try{for(a.s();!(h=a.n()).done;){var r=h.value;r.positionAlign="auto",e.addCue(r,s)}}catch(u){a.e(u)}finally{a.f()}}}},{key:"wh",value:function(t,i){var e=this.ph.audioTracks[i.id];e&&this.ph.audioTracks[c.L](e,!0,new l.yb(t,{detail:i}))}},{key:"xh",value:function(t,i){var e=this.ph.qualities[i.level];e&&this.ph.qualities[c.L](e,!0,new l.yb(t,{detail:i}))}},{key:"yh",value:function(t,i){if(!this.ph.$store.canPlay()){var e=i.details,h=e.type,s=e.live,a=e.totalduration,r=new l.yb(t,{detail:i});this.ph.delegate.U("stream-type-change",{detail:s?"EVENT"===h&&Number.isFinite(a)?"live:dvr":"live":"on-demand",trigger:r}),this.ph.delegate.U("duration-change",{detail:a,trigger:r});var u=this.Ca.media;-1===this.Ca.currentLevel&&this.ph.qualities[c.K](!0,r);var o,d=(0,n.Z)(this.Ca.audioTracks);try{for(d.s();!(o=d.n()).done;){var v=o.value;this.ph.audioTracks[c.N]({id:v.id+"",label:v.name,language:v.lang||"",kind:"main"},r)}}catch(k){d.e(k)}finally{d.f()}var f,y=(0,n.Z)(this.Ca.levels);try{for(y.s();!(f=y.n()).done;){var g=f.value;this.ph.qualities[c.N]({width:g.width,height:g.height,codec:g.codecSet,bitrate:g.bitrate},r)}}catch(k){y.e(k)}finally{y.f()}u.dispatchEvent(new l.yb("canplay",{trigger:r}))}}},{key:"Zb",value:function(t,i){var e,n,h;if(i.fatal)switch(i.type){case"networkError":null===(e=this.Ca)||void 0===e||e.startLoad();break;case"mediaError":null===(n=this.Ca)||void 0===n||n.recoverMediaError();break;default:null===(h=this.Ca)||void 0===h||h.destroy(),this.Ca=null}}},{key:"Bh",value:function(){this.Ca&&(this.Ca.currentLevel=-1)}},{key:"Rf",value:function(){var t=this.ph.qualities;this.Ca&&!t.auto&&(this.Ca[t.switch+"Level"]=t.selectedIndex,c.P&&(this.ta.currentTime=this.ta.currentTime))}},{key:"Ch",value:function(){var t=this.ph.audioTracks;this.Ca&&this.Ca.audioTrack!==t.selectedIndex&&(this.Ca.audioTrack=t.selectedIndex)}},{key:"Jg",value:function(){var t,i;this.ph&&(this.ph.qualities[c.F]=void 0),null===(t=this.Ca)||void 0===t||t.destroy(),this.Ca=null,null===(i=this.uh)||void 0===i||i.call(this),this.uh=null}}]),t}()},500:function(t,i,e){e.d(i,{H:function(){return p}});var n=e(4165),h=e(5861),s=e(5671),a=e(3144),r=e(2175),u=e(2914),o=e(8163),l=e(4942),c=e(1354),d=e(6491),v=e(1469),f=e(1402),y=e(6705),g=function(){function t(i,e){(0,s.Z)(this,t),(0,l.Z)(this,"ih",(0,d.useDisposalBin)()),(0,l.Z)(this,"Vh",!1),(0,l.Z)(this,"Yh",!1),(0,l.Z)(this,"Zh",!1),(0,l.Z)(this,"Wh",new v.R(this.ci.bind(this))),(0,l.Z)(this,"vi",void 0),(0,l.Z)(this,"xi",void 0),this.m=i,this.ph=e,this.ai(),(0,u.cE)(this.bi.bind(this)),(0,c.uG)(this.qh.bind(this))}return(0,a.Z)(t,[{key:"n",get:function(){return this.m.media}},{key:"jg",get:function(){return this.ph.delegate}},{key:"qh",value:function(){this.Wh.N(),this.ih.empty()}},{key:"ci",value:function(){var t=this.m.currentTime;this.ph.$store.currentTime()!==t&&this.Uh(t)}},{key:"ai",value:function(){this.Th("loadstart",this.je),this.Th("abort",this._h),this.Th("emptied",this.di),this.Th("error",this.Zb)}},{key:"ei",value:function(){this.Yh||(this.ih.add(this.Th("loadeddata",this.fi),this.Th("loadedmetadata",this.gi),this.Th("canplay",this.Ub),this.Th("canplaythrough",this.hi),this.Th("durationchange",this.ii),this.Th("play",this.ji),this.Th("progress",this.ki),this.Th("stalled",this.li),this.Th("suspend",this.mi)),this.Yh=!0)}},{key:"ni",value:function(){this.Zh||(this.ih.add(this.Th("pause",this.oi),this.Th("playing",this.pi),this.Th("ratechange",this.qi),this.Th("seeked",this.ri),this.Th("seeking",this.si),this.Th("ended",this.ti),this.Th("volumechange",this.dc),this.Th("waiting",this.ui)),this.Zh=!0)}},{key:"Th",value:function(t,i){return(0,r.yl)(this.n,t,i.bind(this))}},{key:"yi",value:function(t){}},{key:"Uh",value:function(t,i){this.jg.U("time-update",{detail:{currentTime:Math.min(t,this.ph.$store.seekableEnd()),played:this.n.played},trigger:i})}},{key:"je",value:function(t){3!==this.n.networkState?(this.ei(),this.jg.U("load-start",{trigger:t})):this._h(t)}},{key:"_h",value:function(t){this.jg.U("abort",{trigger:t})}},{key:"di",value:function(){this.jg.U("emptied",{trigger:event})}},{key:"fi",value:function(t){this.jg.U("loaded-data",{trigger:t})}},{key:"gi",value:function(t){this.$h(),this.ni(),this.jg.U("volume-change",{detail:{volume:this.n.volume,muted:this.n.muted}}),this.jg.U("loaded-metadata",{trigger:t}),y.I&&(0,o.i)(this.ph.$store.source())&&this.jg.af(this.Xh(),t)}},{key:"Xh",value:function(){return{duration:this.n.duration,buffered:this.n.buffered,seekable:this.n.seekable}}},{key:"$h",value:function(){var t=!Number.isFinite(this.n.duration);this.jg.U("stream-type-change",{detail:t?"live":"on-demand"})}},{key:"ji",value:function(t){this.ph.$store.canPlay&&this.jg.U("play",{trigger:t})}},{key:"oi",value:function(t){(1!==this.n.readyState||this.Vh)&&(this.Vh=!1,this.Wh.N(),this.jg.U("pause",{trigger:t}))}},{key:"Ub",value:function(t){this.jg.af(this.Xh(),t)}},{key:"hi",value:function(t){this.ph.$store.started()||this.jg.U("can-play-through",{trigger:t,detail:this.Xh()})}},{key:"pi",value:function(t){this.Vh=!1,this.jg.U("playing",{trigger:t}),this.Wh.M()}},{key:"li",value:function(t){this.jg.U("stalled",{trigger:t}),this.n.readyState<3&&(this.Vh=!0,this.jg.U("waiting",{trigger:t}))}},{key:"ui",value:function(t){this.n.readyState<3&&(this.Vh=!0,this.jg.U("waiting",{trigger:t}))}},{key:"ti",value:function(t){this.Wh.N(),this.Uh(this.n.duration,t),this.jg.U("end",{trigger:t}),this.ph.$store.loop()?this.wi():this.jg.U("ended",{trigger:t})}},{key:"bi",value:function(){this.ph.$store.paused()&&(0,r.yl)(this.n,"timeupdate",this.Yb.bind(this))}},{key:"Yb",value:function(t){this.Uh(this.n.currentTime,t)}},{key:"ii",value:function(t){this.$h(),this.ph.$store.ended()&&this.Uh(this.n.duration,t),this.jg.U("duration-change",{detail:this.n.duration,trigger:t})}},{key:"dc",value:function(t){this.jg.U("volume-change",{detail:{volume:this.n.volume,muted:this.n.muted},trigger:t})}},{key:"ri",value:function(t){this.Uh(this.n.currentTime,t),this.jg.U("seeked",{detail:this.n.currentTime,trigger:t}),Math.trunc(this.n.currentTime)===Math.trunc(this.n.duration)&&(0,f.y)(this.n.duration)>(0,f.y)(this.n.currentTime)&&(this.Uh(this.n.duration,t),this.n.ended||this.ph.player.dispatchEvent(new r.yb("media-play-request",{trigger:t})))}},{key:"si",value:function(t){this.jg.U("seeking",{detail:this.n.currentTime,trigger:t})}},{key:"ki",value:function(t){this.jg.U("progress",{detail:{buffered:this.n.buffered,seekable:this.n.seekable},trigger:t})}},{key:"wi",value:function(){(0,u.kK)(this.n.controls)&&(this.n.controls=!1),this.ph.player.dispatchEvent(new r.yb("media-loop-request"))}},{key:"mi",value:function(t){this.jg.U("suspend",{trigger:t})}},{key:"qi",value:function(t){this.jg.U("rate-change",{detail:this.n.playbackRate,trigger:t})}},{key:"Zb",value:function(t){var i=this.n.error;i&&this.jg.U("error",{detail:{message:i.message,code:i.code,mediaError:i},trigger:t})}}]),t}(),k=function(){function t(i,e){(0,s.Z)(this,t),this.m=i,this.ph=e,this.Nh.onaddtrack=this.Ph.bind(this),this.Nh.onremovetrack=this.Qh.bind(this),this.Nh.onchange=this.Rh.bind(this),(0,r.yl)(this.ph.audioTracks,"change",this.Sh.bind(this))}return(0,a.Z)(t,[{key:"Nh",get:function(){return this.m.media.audioTracks}},{key:"Ph",value:function(t){var i=t.track;if(""!==i.label){var e={id:i.id+"",label:i.label,language:i.language,kind:i.kind,selected:!1};this.ph.audioTracks[y.N](e,t),i.enabled&&(e.selected=!0)}}},{key:"Qh",value:function(t){var i=this.ph.audioTracks.getById(t.track.id);i&&this.ph.audioTracks[y.W](i,t)}},{key:"Rh",value:function(t){var i=this.Oh();if(i){var e=this.ph.audioTracks.getById(i.id);e&&this.ph.audioTracks[y.L](e,!0,t)}}},{key:"Oh",value:function(){return Array.from(this.Nh).find((function(t){return t.enabled}))}},{key:"Sh",value:function(t){var i=t.detail.current;if(i){var e=this.Nh.getTrackById(i.id);if(e){var n=this.Oh();n&&(n.enabled=!1),e.enabled=!0}}}}]),t}(),p=function(){function t(i){(0,s.Z)(this,t),this.n=i}return(0,a.Z)(t,[{key:"setup",value:function(t){new g(this,t),"audioTracks"in this.media&&new k(this,t)}},{key:"type",get:function(){return""}},{key:"media",get:function(){return this.n}},{key:"paused",get:function(){return this.n.paused}},{key:"muted",get:function(){return this.n.muted},set:function(t){this.n.muted=t}},{key:"volume",get:function(){return this.n.volume},set:function(t){this.n.volume=t}},{key:"currentTime",get:function(){return this.n.currentTime},set:function(t){this.n.currentTime=t}},{key:"playsinline",get:function(){return this.n.hasAttribute("playsinline")},set:function(t){(0,r.P$)(this.n,"playsinline",t)}},{key:"playbackRate",get:function(){return this.n.playbackRate},set:function(t){this.n.playbackRate=t}},{key:"play",value:function(){var t=(0,h.Z)((0,n.Z)().mark((function t(){return(0,n.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",this.n.play());case 1:case"end":return t.stop()}}),t,this)})));return function(){return t.apply(this,arguments)}}()},{key:"pause",value:function(){var t=(0,h.Z)((0,n.Z)().mark((function t(){return(0,n.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",this.n.pause());case 1:case"end":return t.stop()}}),t,this)})));return function(){return t.apply(this,arguments)}}()},{key:"loadSource",value:function(){var t=(0,h.Z)((0,n.Z)().mark((function t(i,e){var h;return(0,n.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:h=i.src,this.n.preload=e,(0,o.b)(h)?this.n.srcObject=h:(this.n.srcObject=null,this.n.src=(0,u.HD)(h)?h:window.URL.createObjectURL(h)),this.n.load();case 4:case"end":return t.stop()}}),t,this)})));return function(i,e){return t.apply(this,arguments)}}()}]),t}()}}]);